{"version":3,"sources":["map.js"],"names":["initMap","map","largeInfoWindow","maps","Map","document","getElementById","center","lng","zoom","zoomControlOptions","zoomControl","ControlPosition","LEFT_CENTER","position","google","mapTypeControlOptions","mapTypeControl","MapTypeControlStyle","HORIZONTAL_BAR","TOP_CENTER","streetViewControl","streetViewControlOptions","LEFT_TOP","fullscreenControl","fullscreenControlOptions","InfoWindow","highlightedIcon","bounds","LatLngBounds","defaultIcon","makeMarkerIcon","length","i","mapModel","locations","title","marker","Animation","DROP","animation","markers","push","addListener","toggleBounce","this","populateInfoWindow","setIcon","extend","fitBounds","infoWindow","setContent","open","setMarker","markerColor","MarkerImage","markerImage","Size","Point","stopAllBounce","setAnimation","BOUNCE"],"mappings":"YAAA,SAAAA,WACAC,IAAIC,GAAAA,QAAJC,KAAAC,IAAAC,SAAAC,eAAA,QACAC,QAASP,IAAU,UAAAQ,IAAA,YACjBP,KAAM,GAEJQ,aAFwD,EAGxDC,oBACAC,SAAAA,OAJwDR,KAAAS,gBAAAC,aAMtDC,gBAAUC,EADQC,uBAGpBC,MAAAA,OAAgBd,KARwCe,oBAAAC,eASxDH,SAAAA,OAAAA,KAAuBJ,gBAAAQ,YAAAC,mBATiC,EAaxDC,0BACAD,SAAAA,OAAmBlB,KAdqCS,gBAAAW,UAe9BC,mBAf8B,EAkBxDC,0BACAD,SAAAA,OAAmBrB,KAnBqCS,gBAAAW,UAqBtDT,kBAAUC,IArB4Cb,gBAA1D,GAAAa,QAAAZ,KAAAuB,UA+BA,KAAIC,GANJC,GAAA,GAAAb,QAAAZ,KAAA0B,aAEID,EAAab,eAAYc,UAEzBC,EAAcC,eAAe,UAE7BJ,EAAAA,EAAAA,EAAAA,SAAkBI,UAAeC,OAArCC,IAAA,CAEA,GAAKnB,GAAWmB,SAAIC,UAASC,GAAUH,SAEjClB,EAAAA,SAAWoB,UAASC,GAAUF,MAE9BG,EAAQF,GAAAA,QAASC,KAAAA,QAGnBlC,IAAKA,IADPa,SAAIuB,EACFpC,MAAKA,EACLa,UAAUA,OAFwBX,KAAAmC,UAAAC,KAGlCH,KAAAA,EACAI,GAAAA,GAJkCN,UAApCO,QAAAC,KAAAL,GAYAA,EAAOM,YAAY,QAAS,WAD5BC,aAAAC,MAEED,IAAAA,MAAAA,KAAa9B,UACbgC,mBAAAD,KAAA3C,mBAGDmC,EALDM,YAAA,YAAA,WAMAE,KAAAE,QAAApB,KAEEU,EAAKU,YAAQpB,WAAb,WADFkB,KAAAE,QAAAjB,KAKCF,EAFDoB,OAAAX,EAAAvB,UAKDb,IAAAgD,UAAArB,GAQH,QAASkB,oBAAmBT,EAAQa,GAApCA,EAASJ,SAAmBT,IAC1Ba,EAAAb,OAAAA,EACAa,EAAIA,WAAA,QAA8Bb,EAAAD,MAAA,UAChCc,EAAWb,KAAAA,IAASA,GACpBa,EAAWC,YAAW,aAAUd,WAChCa,EAAWE,UAAUf,OAEnBa,EAAAA,KAAWG,IAAAA,IAOjB,QAAStB,gBAAeuB,GAYxB,MAbA,IAAAvC,QAAAZ,KAAAoD,YACA,iEAAqCD,EACnC,kBAOA,GAAAvC,QAAOyC,KAAPC,KAAA,GAAA,IACD,GAAA1C,QAAAZ,KAAAuD,MAAA,EAAA,GAHG,GAAI3C,QAAOZ,KAAKuD,MAAM,GAAI,IAK9B,GAAA3C,QAAAZ,KAAAsD,KAAA,GAAA,KAKC,QAAAE,iBAHC,IAAK,GAAI1B,GAAI,EAAGA,EAAIC,SAASO,QAAQT,OAAQC,IAK/CC,SAAAO,QAAAR,GAAA2B,aAAA,MAKI,QAAAhB,cAAAP,GACAsB,OAAAA,EAAAA,eACAtB,EAAOuB,aAAa7C,OADpB4C,gBACAtB,EAAOuB,aAAa7C,OAAOZ,KAAKmC,UAAUuB,SApH9C,GAAI5D,KACAC","file":"map.js","sourcesContent":["var map;\r\nvar largeInfoWindow;\r\nfunction initMap() {\r\n  map = new google.maps.Map(document.getElementById('map'), {\r\n    center: { lat: 22.543389, lng: 114.060508 },\r\n    zoom: 13,\r\n    // 添加地图控件\r\n    zoomControl: true,\r\n    zoomControlOptions: {\r\n      position: google.maps.ControlPosition.LEFT_CENTER\r\n    },\r\n    mapTypeControl: true,\r\n    mapTypeControlOptions: {\r\n      style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,\r\n      position: google.maps.ControlPosition.TOP_CENTER\r\n    },\r\n    // 街区实景\r\n    streetViewControl: true,\r\n    streetViewControlOptions: {\r\n      position: google.maps.ControlPosition.LEFT_TOP,\r\n    },\r\n    // 全屏\r\n    fullscreenControl: true,\r\n    fullscreenControlOptions: {\r\n      position: google.maps.ControlPosition.LEFT_TOP\r\n    },\r\n    disableDefaultUI: true\r\n  });\r\n  // 地点信息窗口\r\n  largeInfoWindow = new google.maps.InfoWindow();\r\n  var bounds = new google.maps.LatLngBounds();\r\n  // 默认的marker样式\r\n  var defaultIcon = makeMarkerIcon('0287D0');\r\n  // marker高亮的颜色\r\n  var highlightedIcon = makeMarkerIcon('BCBCBC');\r\n  // 为每个地点创建marker\r\n  for (var i = 0; i < mapModel.locations.length; i++) {\r\n    // 获取地点的经纬度\r\n    var position = mapModel.locations[i].location;\r\n    // 获取地点的title\r\n    var title = mapModel.locations[i].title;\r\n\r\n    var marker = new google.maps.Marker({\r\n      map: map,\r\n      position: position,\r\n      title: title,\r\n      animation: google.maps.Animation.DROP,\r\n      icon: defaultIcon,\r\n      id: i\r\n    });\r\n\r\n    mapModel.markers.push(marker);\r\n\r\n    // 添加信息窗口\r\n    marker.addListener('click', function() {\r\n      toggleBounce(this);\r\n      // 地图视图偏移\r\n      map.panTo(this.position);\r\n      populateInfoWindow(this, largeInfoWindow);\r\n    });\r\n    // 改变marker的样式\r\n    marker.addListener('mouseover', function() {\r\n      this.setIcon(highlightedIcon);\r\n    });\r\n    marker.addListener('mouseout', function() {\r\n      this.setIcon(defaultIcon);\r\n    });\r\n    // 扩大地图的边界\r\n    bounds.extend(marker.position);\r\n  }\r\n  // 设置边界\r\n  map.fitBounds(bounds);\r\n}\r\n\r\n/**\r\n* 点击maker 时构建一个信息窗口\r\n*/\r\nfunction populateInfoWindow(marker, infoWindow) {\r\n  // 判断这个信息窗口是不是已经打开, 没有打开才重新打开信息窗口\r\n  if (infoWindow.marker !== marker) {\r\n    infoWindow.marker = marker;\r\n    infoWindow.setContent('<div>' + marker.title + '</div>');\r\n    infoWindow.open(map, marker);\r\n    infoWindow.addListener('closeclick', function() {\r\n      infoWindow.setMarker = null;\r\n    });\r\n    infoWindow.open(map, marker);\r\n  }\r\n}\r\n\r\n// 制作marker样式\r\nfunction makeMarkerIcon(markerColor) {\r\n  var markerImage = new google.maps.MarkerImage(\r\n    'http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|' + markerColor +\r\n    '|40|_|%E2%80%A2',\r\n    new google.maps.Size(21, 34),\r\n    new google.maps.Point(0, 0),\r\n    new google.maps.Point(10, 34),\r\n    new google.maps.Size(21, 34));\r\n  return markerImage;\r\n}\r\n\r\n// 停止所有marker的悬浮动画\r\nfunction stopAllBounce() {\r\n  for (var i = 0; i < mapModel.markers.length; i++) {\r\n    mapModel.markers[i].setAnimation(null);\r\n  }\r\n}\r\n\r\n// 为maker添加悬浮动画效果\r\nfunction toggleBounce(marker) {\r\n  if (marker.getAnimation() !== null) {\r\n    marker.setAnimation(null);\r\n  } else {\r\n    // 先停止所有的marker的悬浮\r\n    stopAllBounce();\r\n    marker.setAnimation(google.maps.Animation.BOUNCE);\r\n  }\r\n}\r\n"]}